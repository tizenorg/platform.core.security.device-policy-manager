@startuml
hide footbox
actor Library

Library -> PolicyClient : methodCall
activate PolicyClient

PolicyClient -> Client : methodCall
activate Client

Client -> Connection : createMessage
activate Connection

Client <-- Connection : return Message for method call
deactivate Connection

loop for all parameters
Client -> Client : packParameters
activate Client

Client -> Message : enclose
Activate Message

Message -> Parameter : accept
activate Parameter

Parameter -> Serializer : visit
activate Serializer

Serializer -> MessageBuffer : write
activate MessageBuffer

Serializer <- MessageBuffer
deactivate MessageBuffer

Parameter <- Serializer
deactivate Serializer

Message <-- Parameter
deactivate Parameter

Client <-- Message
deactivate Message
deactivate Client
end

Client -> Connection : send
activate Connection

Connection -> Message : encode
activate Message

Message -> Socket : write
activate Socket

actor PolicyManager
Socket --> PolicyManager : IPC
activate PolicyManager
Note right PolicyManager: PolicyManager dispatchs method call handler appropreate to the message
Message <-- Socket
deactivate Socket

Connection <-- Message
deactivate Message

Client <-- Connection
deactivate Connection

... Wait for response...


@enduml
